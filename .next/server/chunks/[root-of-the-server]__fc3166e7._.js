module.exports = {

"[project]/.next-internal/server/app/api/data/route/actions.js [app-rsc] (server actions loader, ecmascript)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
}}),
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/@opentelemetry/api [external] (@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("@opentelemetry/api", () => require("@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/fs [external] (fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}}),
"[externals]/path [external] (path, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}}),
"[project]/src/lib/data.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "getActionItems": (()=>getActionItems),
    "getEvents": (()=>getEvents),
    "getExcelMetadata": (()=>getExcelMetadata),
    "getImpactInitiatives": (()=>getImpactInitiatives),
    "getPillarById": (()=>getPillarById),
    "getPillars": (()=>getPillars),
    "getUsers": (()=>getUsers),
    "getValueMapData": (()=>getValueMapData),
    "getValueMapVersions": (()=>getValueMapVersions),
    "getWhatsNewEntries": (()=>getWhatsNewEntries),
    "getWhatsNewSectionContent": (()=>getWhatsNewSectionContent),
    "migrateValueMapFileNames": (()=>migrateValueMapFileNames),
    "readExcelData": (()=>readExcelData),
    "readMonthlyData": (()=>readMonthlyData),
    "writeActionItems": (()=>writeActionItems),
    "writeData": (()=>writeData),
    "writeEvents": (()=>writeEvents),
    "writeExcelData": (()=>writeExcelData),
    "writeExcelMetadata": (()=>writeExcelMetadata),
    "writeImpactInitiatives": (()=>writeImpactInitiatives),
    "writeMonthlyData": (()=>writeMonthlyData),
    "writeUsers": (()=>writeUsers),
    "writeValueMapData": (()=>writeValueMapData),
    "writeWhatsNewEntries": (()=>writeWhatsNewEntries),
    "writeWhatsNewSectionContent": (()=>writeWhatsNewSectionContent)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$trending$2d$up$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__TrendingUp$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/trending-up.js [app-route] (ecmascript) <export default as TrendingUp>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$shield$2d$check$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__ShieldCheck$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/shield-check.js [app-route] (ecmascript) <export default as ShieldCheck>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$scaling$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__Scaling$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/scaling.js [app-route] (ecmascript) <export default as Scaling>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$cpu$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__Cpu$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/cpu.js [app-route] (ecmascript) <export default as Cpu>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$landmark$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__Landmark$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/landmark.js [app-route] (ecmascript) <export default as Landmark>");
var __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/fs [external] (fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/path [external] (path, cjs)");
;
;
;
// Hardcoded icons mapping
const pillarIcons = {
    'improving-productivity': __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$trending$2d$up$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__TrendingUp$3e$__["TrendingUp"],
    'building-reliable-products': __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$shield$2d$check$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__ShieldCheck$3e$__["ShieldCheck"],
    'making-design-resilient': __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$scaling$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__Scaling$3e$__["Scaling"],
    'adopting-emerging-technologies': __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$cpu$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__Cpu$3e$__["Cpu"],
    'world-class-corporate-governance': __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$landmark$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__Landmark$3e$__["Landmark"]
};
const dataFilePath = (filename)=>__TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(process.cwd(), 'src', 'lib', 'data', filename);
const monthlyDataDirectoryPath = (dir)=>__TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(process.cwd(), 'src', 'lib', 'data', dir);
const valueMapVersionsPath = ()=>__TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(process.cwd(), 'src', 'lib', 'data', 'value-map-versions');
async function readData() {
    try {
        const fileContent = await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].readFile(dataFilePath('data.json'), 'utf-8');
        let jsonData = JSON.parse(fileContent);
        const autoCalculatedKeys = [
            'tech-sphere-sessions',
            'arc-trainings',
            'app-sherpas',
            'explore-resiliency-program',
            'dti-tech-blogs',
            'hackathons',
            'industry-events',
            'squad-onboarding',
            'regression-testing-automation',
            'junit-adoption',
            'maintenance-screens',
            'api-performance'
        ];
        const dataCache = {};
        for (const key of autoCalculatedKeys){
            dataCache[key] = await readExcelData(key);
        }
        // Attach total participants for tech sphere sessions
        const techSessionsData = dataCache['tech-sphere-sessions'];
        if (techSessionsData && techSessionsData.rows.length > 0) {
            const totalParticipants = techSessionsData.rows.reduce((sum, row)=>sum + (Number(row['Participation']) || 0), 0);
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'tech-sphere-sessions' ? {
                            ...subItem,
                            totalParticipants
                        } : subItem)
                }));
        }
        // Attach total participants and session count for ARC trainings
        const arcTrainingsData = dataCache['arc-trainings'];
        if (arcTrainingsData && arcTrainingsData.rows.length > 0) {
            const totalParticipants = arcTrainingsData.rows.reduce((sum, row)=>sum + (Number(row['Participation']) || 0), 0);
            const sessionsCount = arcTrainingsData.rows.length;
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'arc-trainings' ? {
                            ...subItem,
                            totalParticipants,
                            percentageComplete: sessionsCount
                        } : subItem)
                }));
        }
        // Attach App Sherpas count
        const appSherpasData = dataCache['app-sherpas'];
        if (appSherpasData && appSherpasData.rows.length > 0) {
            const sherpasCount = appSherpasData.rows.length;
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'app-sherpas' ? {
                            ...subItem,
                            percentageComplete: sherpasCount
                        } : subItem)
                }));
        }
        // Attach completed assessment count for Explore Resiliency Program
        const resiliencyData = dataCache['explore-resiliency-program'];
        if (resiliencyData && resiliencyData.rows.length > 0) {
            const completedAssessments = resiliencyData.rows.filter((row)=>row['Status'] === 'Assessment Completed').length;
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'explore-resiliency-program' ? {
                            ...subItem,
                            percentageComplete: completedAssessments
                        } : subItem)
                }));
        }
        // Attach published blogs count for DTI Tech Blogs
        const blogsData = dataCache['dti-tech-blogs'];
        if (blogsData) {
            const publishedBlogs = blogsData.rows.length;
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'dti-tech-blogs' ? {
                            ...subItem,
                            percentageComplete: publishedBlogs
                        } : subItem)
                }));
        }
        // Attach hackathons count
        const hackathonsData = await readExcelData('hackathons');
        if (hackathonsData && Array.isArray(hackathonsData)) {
            const hackathonsCount = hackathonsData.length;
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'hackathons' ? {
                            ...subItem,
                            percentageComplete: hackathonsCount
                        } : subItem)
                }));
        }
        // Attach industry events count
        const industryEventsData = await readExcelData('industry-events');
        if (industryEventsData && Array.isArray(industryEventsData)) {
            const industryEventsCount = industryEventsData.length;
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'industry-events' ? {
                            ...subItem,
                            percentageComplete: industryEventsCount
                        } : subItem)
                }));
        }
        // Attach SQUAD onboarding count
        const squadData = dataCache['squad-onboarding'];
        if (squadData && squadData.rows.length > 0) {
            const onboardedCount = squadData.rows.length;
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'squad-onboarding' ? {
                            ...subItem,
                            percentageComplete: onboardedCount
                        } : subItem)
                }));
        }
        // Attach row counts for 'Building Reliable Products' sub-items (except Maintenance Screens)
        const newAutoCalcKeys = [
            'regression-testing-automation',
            'junit-adoption',
            'api-performance'
        ];
        for (const key of newAutoCalcKeys){
            const data = dataCache[key];
            if (data && data.rows.length > 0) {
                const rowCount = data.rows.length;
                jsonData = jsonData.map((pillar)=>({
                        ...pillar,
                        subItems: pillar.subItems.map((subItem)=>subItem.dataKey === key ? {
                                ...subItem,
                                percentageComplete: rowCount
                            } : subItem)
                    }));
            }
        }
        // Attach implemented screens count for Maintenance Screens
        const maintenanceScreensData = dataCache['maintenance-screens'];
        if (maintenanceScreensData && maintenanceScreensData.rows.length > 0) {
            const implementedScreens = maintenanceScreensData.rows.filter((row)=>String(row['Status'] || '').toLowerCase().includes('live')).length;
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'maintenance-screens' ? {
                            ...subItem,
                            percentageComplete: implementedScreens
                        } : subItem)
                }));
        }
        // Attach Jira Assistant Adoption data
        const jiraAdoptionData = await readMonthlyData('jira-assistant-adoption');
        if (jiraAdoptionData && Object.keys(jiraAdoptionData).length > 0) {
            const latestMonth = Object.keys(jiraAdoptionData).sort().pop();
            let latestMonthAdoption = 0;
            if (latestMonth && jiraAdoptionData[latestMonth]) {
                const latestMonthRows = jiraAdoptionData[latestMonth].rows;
                const testCases = latestMonthRows.filter((row)=>row['issue_type'] === 'Test');
                const totalTestCases = testCases.length;
                const jaTestCases = testCases.filter((row)=>row['is_created_via_JA'] === 1).length;
                if (totalTestCases > 0) {
                    latestMonthAdoption = Math.round(jaTestCases / totalTestCases * 100);
                }
            }
            jsonData = jsonData.map((pillar)=>({
                    ...pillar,
                    subItems: pillar.subItems.map((subItem)=>subItem.dataKey === 'jira-assistant-adoption' ? {
                            ...subItem,
                            percentageComplete: latestMonthAdoption,
                            metricName: 'Latest Month Test Case Adoption'
                        } : subItem)
                }));
        }
        // Attach icons back to the data
        return jsonData.map((pillar)=>({
                ...pillar,
                icon: pillarIcons[pillar.id] || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$landmark$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__default__as__Landmark$3e$__["Landmark"]
            }));
    } catch (error) {
        console.error("Could not read or parse data.json:", error);
        // Fallback to empty array or some default structure if file read fails
        return [];
    }
}
async function getPillars() {
    return await readData();
}
async function getPillarById(id) {
    const pillars = await readData();
    return pillars.find((p)=>p.id === id);
}
async function writeData(data) {
    try {
        // We need to remove the icon and other dynamic properties before writing to JSON
        const dataToWrite = data.map(({ icon, ...rest })=>{
            rest.subItems = rest.subItems.map(({ totalParticipants, ...subRest })=>subRest);
            return rest;
        });
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].writeFile(dataFilePath('data.json'), JSON.stringify(dataToWrite, null, 2), 'utf-8');
    } catch (error) {
        console.error("Could not write to data.json:", error);
        throw new Error("Failed to save data.");
    }
}
async function readExcelData(fileKey) {
    try {
        const fileContent = await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].readFile(dataFilePath(`${fileKey}.json`), 'utf-8');
        if (fileKey === 'hackathons' || fileKey === 'industry-events') {
            const data = JSON.parse(fileContent);
            // Ensure the data is an array for these keys.
            if (Array.isArray(data)) {
                return data;
            }
            if (data && Array.isArray(data.rows)) {
                return data.rows;
            }
            return [];
        }
        if (fileKey === 'users') {
            const users = JSON.parse(fileContent);
            const rows = users.map((user)=>({
                    'Name': user.name,
                    'Email': user.email,
                    'LOBT': user.lobt
                }));
            const headers = users.length > 0 ? Object.keys(rows[0]) : [];
            return {
                headers,
                rows
            };
        }
        return JSON.parse(fileContent);
    } catch (error) {
        // It's okay if the file doesn't exist, it just means no data has been uploaded yet.
        if (error instanceof Error && error.code === 'ENOENT') {
            try {
                let emptyContent;
                if (fileKey === 'hackathons' || fileKey === 'industry-events' || fileKey === 'users' || fileKey === 'impact-initiatives' || fileKey === 'whats-new') {
                    emptyContent = JSON.stringify([]);
                } else {
                    emptyContent = JSON.stringify({
                        headers: [],
                        rows: []
                    }, null, 2);
                }
                await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].writeFile(dataFilePath(`${fileKey}.json`), emptyContent, 'utf-8');
                if (fileKey === 'users') {
                    return {
                        headers: [
                            'Name',
                            'Email',
                            'LOBT'
                        ],
                        rows: []
                    };
                }
                if (fileKey === 'hackathons' || fileKey === 'industry-events' || fileKey === 'impact-initiatives' || fileKey === 'whats-new') {
                    return [];
                }
                return {
                    headers: [],
                    rows: []
                };
            } catch (writeError) {
                console.error(`Could not create ${fileKey}.json:`, writeError);
                return null;
            }
        }
        console.error(`Could not read or parse ${fileKey}.json:`, error);
        return null;
    }
}
async function writeExcelData(fileKey, data) {
    try {
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].writeFile(dataFilePath(`${fileKey}.json`), JSON.stringify(data, null, 2), 'utf-8');
    } catch (error) {
        console.error(`Could not write to ${fileKey}.json:`, error);
        throw new Error(`Failed to save ${fileKey} data.`);
    }
}
async function readMonthlyData(dir, month) {
    const dirPath = monthlyDataDirectoryPath(dir);
    try {
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].mkdir(dirPath, {
            recursive: true
        });
        const files = await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].readdir(dirPath);
        if (month) {
            const fileName = `${month}.json`;
            if (files.includes(fileName)) {
                const fileContent = await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].readFile(__TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(dirPath, fileName), 'utf-8');
                if (fileContent.trim() === '') return {
                    [month]: {
                        headers: [],
                        rows: []
                    }
                };
                return {
                    [month]: JSON.parse(fileContent)
                };
            }
            return null;
        }
        const allData = {};
        for (const file of files){
            if (__TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].extname(file) === '.json') {
                const monthKey = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].basename(file, '.json');
                const fileContent = await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].readFile(__TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(dirPath, file), 'utf-8');
                if (fileContent.trim() === '') {
                    allData[monthKey] = {
                        headers: [],
                        rows: []
                    };
                } else {
                    allData[monthKey] = JSON.parse(fileContent);
                }
            }
        }
        return allData;
    } catch (error) {
        console.error(`Could not read from directory ${dir}:`, error);
        return null;
    }
}
async function writeMonthlyData(dir, month, data) {
    const dirPath = monthlyDataDirectoryPath(dir);
    try {
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].mkdir(dirPath, {
            recursive: true
        });
        const filePath = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(dirPath, `${month}.json`);
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].writeFile(filePath, JSON.stringify(data, null, 2), 'utf-8');
    } catch (error) {
        console.error(`Could not write to ${dir}/${month}.json:`, error);
        throw new Error(`Failed to save ${dir} data for ${month}.`);
    }
}
async function getValueMapVersions() {
    const dirPath = valueMapVersionsPath();
    try {
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].mkdir(dirPath, {
            recursive: true
        });
        const files = await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].readdir(dirPath);
        const versions = files.filter((file)=>file.endsWith('.json')).sort((a, b)=>{
            const numA = parseInt(a.replace('.json', ''), 10);
            const numB = parseInt(b.replace('.json', ''), 10);
            if (isNaN(numA) || isNaN(numB)) {
                // Fallback for non-numeric filenames if any exist
                return b.localeCompare(a);
            }
            return numB - numA;
        });
        return {
            versions,
            latest: versions[0] || null
        };
    } catch (error) {
        console.error("Could not read value map versions:", error);
        return {
            versions: [],
            latest: null
        };
    }
}
async function getValueMapData(version) {
    try {
        const dirPath = valueMapVersionsPath();
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].mkdir(dirPath, {
            recursive: true
        });
        let versionToFetch = version;
        if (!versionToFetch || versionToFetch === 'latest') {
            const { latest } = await getValueMapVersions();
            if (!latest) {
                // If no versions exist, create a new default version.
                const defaultData = {
                    outcomes: [],
                    drivers: [],
                    levers: [],
                    outcomeGroups: [],
                    driverGroups: []
                };
                await writeValueMapData(defaultData, true); // Save as new version
                return defaultData;
            }
            versionToFetch = latest;
        }
        if (!versionToFetch) {
            throw new Error("No version specified and no latest version found.");
        }
        const filePath = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(dirPath, versionToFetch);
        const fileContent = await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].readFile(filePath, 'utf-8');
        return JSON.parse(fileContent);
    } catch (error) {
        console.error(`Could not read value map version ${version}:`, error);
        // If a specific version read fails, it's better to return an error than an empty object
        throw new Error(`Failed to read Value Map data for version: ${version}.`);
    }
}
async function writeValueMapData(data, asNewVersion) {
    const dirPath = valueMapVersionsPath();
    try {
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].mkdir(dirPath, {
            recursive: true
        });
        let versionToSave;
        if (asNewVersion) {
            versionToSave = `${Date.now()}.json`;
        } else {
            const { latest } = await getValueMapVersions();
            versionToSave = latest || `${Date.now()}.json`;
        }
        const filePath = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(dirPath, versionToSave);
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].writeFile(filePath, JSON.stringify(data, null, 2), 'utf-8');
    } catch (error) {
        console.error("Could not write to value-map-versions:", error);
        throw new Error("Failed to save Value Map data.");
    }
}
async function migrateValueMapFileNames() {
    const dirPath = valueMapVersionsPath();
    let migrated = 0;
    let errors = 0;
    let files = [];
    try {
        files = await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].readdir(dirPath);
        for (const file of files){
            if (file.includes(':') || file.includes('T')) {
                const oldPath = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(dirPath, file);
                try {
                    // Robustly parse the ISO-like string from the filename
                    const dateString = file.replace('.json', '');
                    const date = new Date(dateString);
                    if (isNaN(date.getTime())) {
                        throw new Error(`Could not parse date from filename: ${file}`);
                    }
                    const timestamp = date.getTime();
                    const newName = `${timestamp}.json`;
                    const newPath = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(dirPath, newName);
                    if (!files.includes(newName)) {
                        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].rename(oldPath, newPath);
                        migrated++;
                    }
                } catch (migrationError) {
                    console.error(`Failed to migrate ${file}:`, migrationError);
                    errors++;
                }
            }
        }
        return {
            migrated,
            errors
        };
    } catch (error) {
        console.error("Migration failed:", error);
        return {
            migrated: 0,
            errors: files.length
        };
    }
}
// User and Action Item data functions
async function readJsonFile(fileName, defaultValue) {
    const filePath = dataFilePath(fileName);
    try {
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].mkdir(__TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].dirname(filePath), {
            recursive: true
        });
        const fileContent = await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].readFile(filePath, 'utf-8');
        return JSON.parse(fileContent);
    } catch (error) {
        if (error instanceof Error && error.code === 'ENOENT') {
            await writeJsonFile(fileName, defaultValue);
            return defaultValue;
        }
        console.error(`Could not read or parse ${fileName}:`, error);
        throw new Error(`Failed to read ${fileName}.`);
    }
}
async function writeJsonFile(fileName, data) {
    try {
        const filePath = dataFilePath(fileName);
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].mkdir(__TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].dirname(filePath), {
            recursive: true
        });
        await __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["promises"].writeFile(filePath, JSON.stringify(data, null, 2), 'utf-8');
    } catch (error) {
        console.error(`Could not write to ${fileName}:`, error);
        throw new Error(`Failed to save ${fileName}.`);
    }
}
const getUsers = ()=>readJsonFile('users.json', []);
const writeUsers = (data)=>writeJsonFile('users.json', data);
const getActionItems = ()=>readJsonFile('action-items.json', []);
const writeActionItems = (data)=>writeJsonFile('action-items.json', data);
const getEvents = ()=>readJsonFile('events.json', []);
const writeEvents = (data)=>writeJsonFile('events.json', data);
const getImpactInitiatives = ()=>readJsonFile('impact-initiatives.json', []);
const writeImpactInitiatives = (data)=>writeJsonFile('impact-initiatives.json', data);
const getWhatsNewEntries = ()=>readJsonFile('whats-new.json', []);
const writeWhatsNewEntries = (data)=>writeJsonFile('whats-new.json', data);
const getWhatsNewSectionContent = ()=>readJsonFile('whats-new-sections.json', {
        comingSoonItems: [],
        joinTeamParagraphs: []
    });
const writeWhatsNewSectionContent = (data)=>writeJsonFile('whats-new-sections.json', data);
const getExcelMetadata = ()=>readJsonFile('excel-metadata.json', {});
const writeExcelMetadata = (data)=>writeJsonFile('excel-metadata.json', data);
}}),
"[project]/src/app/api/data/route.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "GET": (()=>GET),
    "PATCH": (()=>PATCH),
    "POST": (()=>POST)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/data.ts [app-route] (ecmascript)");
;
;
async function GET(request) {
    const { searchParams } = new URL(request.url);
    const fileKey = searchParams.get('key');
    const month = searchParams.get('month'); // e.g., '2024-08'
    const includeMetadata = searchParams.get('meta');
    const version = searchParams.get('version');
    if (fileKey === 'value-map-versions') {
        try {
            const { versions, latest } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getValueMapVersions"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                versions,
                latest
            });
        } catch (error) {
            console.error("Failed to get value map versions", error);
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (fileKey === 'value-map') {
        try {
            const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getValueMapData"])(version);
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
        } catch (error) {
            console.error("Failed to fetch value map data", error);
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (includeMetadata && fileKey) {
        try {
            const metadata = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getExcelMetadata"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                lastUpdated: metadata[fileKey] || null
            });
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (fileKey === 'users') {
        try {
            const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getUsers"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (fileKey === 'action-items') {
        try {
            const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getActionItems"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (fileKey === 'events') {
        try {
            const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getEvents"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (fileKey === 'impact-initiatives') {
        try {
            const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getImpactInitiatives"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (fileKey === 'whats-new') {
        try {
            const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getWhatsNewEntries"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (fileKey === 'whats-new-sections') {
        try {
            const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getWhatsNewSectionContent"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (fileKey === 'jira-assistant-adoption') {
        try {
            const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["readMonthlyData"])(fileKey, month);
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
    if (fileKey) {
        try {
            if (fileKey === 'hackathons') {
                const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["readExcelData"])('hackathons');
                // hackathons are not in ExcelData format, they are just an array in the `rows` property
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data ?? []);
            }
            if (fileKey === 'industry-events') {
                const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["readExcelData"])('industry-events');
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data ?? []);
            }
            if (fileKey === 'squad-onboarding') {
                const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["readExcelData"])('squad-onboarding');
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
            }
            if (fileKey === 'arc-trainings') {
                const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["readExcelData"])('arc-trainings');
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
            }
            if (fileKey === 'app-sherpas') {
                const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["readExcelData"])('app-sherpas');
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
            }
            if (fileKey === 'regression-testing-automation' || fileKey === 'junit-adoption' || fileKey === 'maintenance-screens' || fileKey === 'api-performance' || fileKey === 'users') {
                const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["readExcelData"])(fileKey);
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
            }
            const data = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["readExcelData"])(fileKey);
            if (data) {
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
            } else {
                return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Not Found', {
                    status: 404
                });
            }
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    } else {
        try {
            const pillars = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getPillars"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(pillars);
        } catch (error) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
                status: 500
            });
        }
    }
}
async function POST(request) {
    try {
        const body = await request.json();
        let excelMetadataUpdated = false;
        if (body.pillars) {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeData"])(body.pillars);
        }
        if (body.valueMap) {
            const asNewVersion = body.saveAsNewVersion || false;
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeValueMapData"])(body.valueMap, asNewVersion);
        }
        if (body.actionItems) {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeActionItems"])(body.actionItems);
        }
        if (body.events) {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeEvents"])(body.events);
        }
        if (body.impactInitiatives) {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeImpactInitiatives"])(body.impactInitiatives);
        }
        if (body.whatsNewEntries) {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeWhatsNewEntries"])(body.whatsNewEntries);
        }
        if (body.whatsNewSectionContent) {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeWhatsNewSectionContent"])(body.whatsNewSectionContent);
        }
        if (body.excelData) {
            const metadata = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getExcelMetadata"])();
            const now = new Date().toISOString();
            for(const key in body.excelData){
                if (Object.prototype.hasOwnProperty.call(body.excelData, key)) {
                    if (body.excelData[key]) {
                        // special handling for certain keys
                        if (key === 'hackathons') {
                            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeExcelData"])(key, body.excelData[key]);
                            metadata[key] = now;
                            excelMetadataUpdated = true;
                        } else if (key === 'industry-events') {
                            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeExcelData"])(key, body.excelData[key]);
                            metadata[key] = now;
                            excelMetadataUpdated = true;
                        } else if (key.startsWith('jira-assistant-adoption')) {
                            const [, month] = key.split(':');
                            if (month) {
                                await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeMonthlyData"])('jira-assistant-adoption', month, body.excelData[key]);
                                metadata[`jira-assistant-adoption`] = now; // Store one timestamp for the whole dataset
                                excelMetadataUpdated = true;
                            }
                        } else if (key === 'users') {
                            const usersData = body.excelData[key].rows.map((row)=>({
                                    name: row['Name'],
                                    email: row['Email'],
                                    lobt: row['LOBT']
                                }));
                            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeUsers"])(usersData);
                        } else {
                            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeExcelData"])(key, body.excelData[key]);
                            metadata[key] = now;
                            excelMetadataUpdated = true;
                        }
                    }
                }
            }
            if (excelMetadataUpdated) {
                await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["writeExcelMetadata"])(metadata);
            }
        }
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Data saved successfully', {
            status: 200
        });
    } catch (error) {
        console.error('Save Error:', error);
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
            status: 500
        });
    }
}
async function PATCH(request) {
    try {
        const body = await request.json();
        if (body.action === 'migrate-value-map-filenames') {
            const result = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$data$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["migrateValueMapFileNames"])();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(result);
        }
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Invalid action', {
            status: 400
        });
    } catch (error) {
        console.error('PATCH Error:', error);
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"]('Internal Server Error', {
            status: 500
        });
    }
}
}}),

};

//# sourceMappingURL=%5Broot-of-the-server%5D__fc3166e7._.js.map